
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Covariance &#8212; SplitWavePy 1.0.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="SplitWavePy Paper" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="covariance">
<span id="id1"></span><h1>Covariance<a class="headerlink" href="#covariance" title="Permalink to this headline">¶</a></h1>
<p>The covariance <span class="math">\({cov} (\mathbf{x},\mathbf{y})\)</span> of the energy measured on traces <span class="math">\((\mathbf{x},\mathbf{y})\)</span> representing the two orthogonal components in the plane of the shear wave is fundamental to the grid search methods for finding the best fitting inverse splitting operator.  These methods are the Silver and Chan method which seeks to miniminise the energy on the transverse component, and the rotation correlation method which seeks to maximise the correlation between fast and slow wavelets.</p>
<p>The covariance between two traces <span class="math">\((\mathbf{x}, \mathbf{y})\)</span> each containing <span class="math">\(N\)</span> samples is</p>
<div class="math">
\[{cov} (\mathbf{x}, \mathbf{y})=\frac {1}{N} \sum _{m=0}^{N-1}(\mathbf{x}[m] -\mu _{x})(\mathbf{y}[m]-\mu _{y}),\]</div>
<p>where <span class="math">\(\mu_{x}\)</span> is the mean of <span class="math">\(\mathbf{x}\)</span>.  Note that the covariance of a trace with itself is simply its variance</p>
<div class="math">
\[ \begin{align}\begin{aligned}{cov} (\mathbf{x},\mathbf{x}) = \sigma_{x}^{2},\\{cov} (\mathbf{x}, \mathbf{y}) = {cov} (\mathbf{y}, \mathbf{x}),\\{cov} (\mathbf{x}, \mathbf{y}) = \sigma_x \sigma_y \rho_{\mathbf{x},\mathbf{y}}.\end{aligned}\end{align} \]</div>
<p>Where <span class="math">\(\sigma_x\)</span> is the standard deviation of <span class="math">\(\mathbf{x}\)</span>, and <span class="math">\(\rho\)</span> is the normalised correlation coefficient, also known as Pearson’s r. The covariance matrix <span class="math">\(\mathbf{C}(\mathbf{x},\mathbf{y})\)</span> for this can be viewed as</p>
<div class="math">
\[\begin{split}\mathbf{C}(\mathbf{x},\mathbf{y}) = \begin{bmatrix}
{cov} (\mathbf{x},\mathbf{x}) &amp; {cov} (\mathbf{x},\mathbf{y}) \\
                                                          &amp; {cov} (\mathbf{y},\mathbf{y})
                                                        \end{bmatrix}
                                                                  = \begin{bmatrix}
                        \sigma_x^2 &amp; \sigma_x \sigma_y \rho_{\mathbf{x},\mathbf{y}} \\
                                                          &amp; \sigma_y^2
                                                        \end{bmatrix}.\end{split}\]</div>
<p>Pearson’s r is the statistic that is maximised in the rotation correlation method.  It can be simply plucked from the covariance matrix.</p>
<div class="math">
\[\rho_{\mathbf{x},\mathbf{y}}  = \frac{C_{1,2}}{(C_{1,1} C_{2,2})^{1/2}}\]</div>
<p>If the mean of each trace is zero then the covariance matrix can be cheaply calculated.</p>
<div class="math">
\[\begin{split}\mathbf{C}(\mathbf{x},\mathbf{y}) = \frac{1}{N}
                \begin{bmatrix}
\sum{x_i^2} &amp; \sum{x_i y_i} \\
                  &amp; \sum{y_i^2}
  \end{bmatrix}\end{split}\]</div>
<p>The energy of a discrete-time signal is equal to <span class="math">\(\sum_{i=0}^{N-1}x_{i}^2\)</span>.
If <span class="math">\(x\)</span> can be guaranteed to point in the <em>polarisation</em> direction, then <span class="math">\(y\)</span> will point in the <em>transverse</em> direction.  The Silver and Chan Method seeks to minimise the energy on the transverse component, provided <span class="math">\(x\)</span> and <span class="math">\(y\)</span> are suitably rotated then this statistic is simply the lower right entry of the covariance matrix.</p>
<p>If the polarisation of the shear wave is not known then a guess can be made that this principal direction is the principal eigenvector of the covariance matrix.  This is the Silver and Chan eigenvalue method which seeks to minimise the small eigenvalue of the covariance matrix <span class="math">\(\lambda_2\)</span>, which is equivalent to <span class="math">\(\sigma_y^2\)</span> if the polarisation really does math the principal eigenvector.</p>
<div class="section" id="grid-search">
<h2>Grid Search<a class="headerlink" href="#grid-search" title="Permalink to this headline">¶</a></h2>
<p>Now that we know which statistics from the covariance matrix are useful for measuring shear wave splitting we can consider the grid search.</p>
<p>The rotation exchanges energy between traces</p>
<div class="math">
\[\begin{split}\mathbf{R}(\theta) = \begin{bmatrix}
cos(\theta) &amp; -sin(\theta) \\
sin(\theta) &amp; cos(\theta)
\end{bmatrix}.\end{split}\]</div>
<p>Notice that the term in the upper right corner has similar form to a cross-correlation with zero lag (<span class="math">\(j=0\)</span>).</p>
<p>The lag can be easily converted to a meaningful delay time if the sampling interval <span class="math">\(\Delta\)</span> of the data is known</p>
<div class="math">
\[\delta t = n \Delta.\]</div>
<div class="math">
\[(\mathbf{x} \star \mathbf{y})_j\ {\stackrel {\mathrm {def} }{=}}\sum _{m=-\infty }^{\infty }x_i y_{i+j}.\]</div>
<p>Furthermore, if energy in the window is conserved for all lags, then the terms in the upper left and lower right of the covariance matrix are constant.</p>
<div class="math">
\[\begin{split}\mathbf{C}(\mathbf{x},\mathbf{y})_j = \frac{1}{N}
                \begin{bmatrix}
\sum{x_i^2}  &amp; (\mathbf{x} \star \mathbf{y})_j \\
                  &amp; \sum{y_i^2}
  \end{bmatrix}\end{split}\]</div>
<p>As a consequence of the convolution theorem a computational speedup is achieved by calculating the cross-correlation in the frequency domain.</p>
<div class="math">
\[ \begin{align}\begin{aligned}\mathbf{X} = \mathcal{F} \{ \mathbf{x} \}\\\mathbf{Y} = \mathcal{F} \{ \mathbf{y} \}\\(\mathbf{x} \star \mathbf{y})_j = (\mathcal{F}^{-1} \{ \mathbf{X} \mathbf{Y}^* \})_j\end{aligned}\end{align} \]</div>
<p>By Parseval’s theorem the sum of squares in the time domain signal is closely related to the sum of squares on its Fourier transformed frequency domain companion.</p>
<div class="math">
\[\sum _{i=0}^{N-1}x_{i}^2 = {\frac {1}{N}} \sum _{i=0}^{N-1}|X_i|^{2}\]</div>
<p>This leads to an algorithm for the covariance matrix in the frequency domain</p>
<div class="math">
\[\begin{split}\mathbf{C}(\mathbf{x},\mathbf{y})_j = \frac{1}{N}
              \begin{bmatrix}
              \frac {1}{N} \sum |\mathbf{X}|^{2}  &amp;
              (\mathcal{F}^{-1} \{ \mathbf{X} \mathbf{Y}^* \})_j \\
                &amp; \frac {1}{N} \sum |\mathbf{Y}|^{2}
\end{bmatrix}\end{split}\]</div>
</div>
<div class="section" id="practical-issues">
<h2>Practical Issues<a class="headerlink" href="#practical-issues" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">SplitWavePy</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Covariance</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#grid-search">Grid Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="#practical-issues">Practical Issues</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">SplitWavePy Paper</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Jack Walpole.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/covariance.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>